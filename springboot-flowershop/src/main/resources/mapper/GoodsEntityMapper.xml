<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aim.flowershop.dao.GoodsEntityMapper">
  <resultMap id="BaseResultMap" type="com.aim.flowershop.dao.entity.GoodsEntity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="VARCHAR" property="id" />
    <result column="goods_id" jdbcType="INTEGER" property="goodsId" />
    <result column="goods_name" jdbcType="VARCHAR" property="goodsName" />
    <result column="sales_num" jdbcType="INTEGER" property="salesNum" />
    <result column="reserve_num" jdbcType="INTEGER" property="reserveNum" />
    <result column="unit" jdbcType="VARCHAR" property="unit" />
    <result column="price" jdbcType="VARCHAR" property="price" />
    <result column="comment" jdbcType="VARCHAR" property="comment" />

  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    goods_id,goods_name,sales_num,reserve_num,unit,price,comment
  </sql>
  <sql id="Blob_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    project_content
  </sql>

  <!--根据id查看商品详细信息-->
  <select id="selectGoodsById" parameterType="java.lang.Integer" resultType="map">
    select
    goods_id,goods_name,sales_num,reserve_num,unit,price,comment,pic
    from goods
    where goods_id = #{goodsId,jdbcType=INTEGER}
  </select>

  <!--查询全部商品信息-->
  <select id="queryAllGoods" resultType="map">
    SELECT
    goods_id as goodsId,goods_name as goodsName,sales_num as salesNum,
    reserve_num as reserveNum,unit,price,comment,pic
    FROM goods
  </select>

  <!--添加一个商品-->
  <insert id="addGoods" parameterType="com.aim.flowershop.dao.entity.GoodsEntity">
    insert into goods (goods_id,goods_name,sales_num,reserve_num,unit,price,comment,pic)
    values (#{goodsId,jdbcType=INTEGER},#{goodsName,jdbcType=VARCHAR},
    #{salesNum,jdbcType=INTEGER},#{reserveNum,jdbcType=INTEGER},
    #{unit,jdbcType=VARCHAR},#{price,jdbcType=VARCHAR},
    #{comment,jdbcType=VARCHAR},#{pic,jdbcType=VARCHAR})
  </insert>

  <!--根据id删除商品-->
  <delete id="deleteGoodsById" parameterType="java.lang.Integer" >
    delete from goods
    where goods_id = #{goodsId,jdbcType=INTEGER}
  </delete>

  <!--更新商品价格和余量-->
  <update id="updateGoods" parameterType="map" >
    update goods set price = #{price,jdbcType=VARCHAR},reserve_num=#{reserveNum,jdbcType=VARCHAR}
    where goods_id = #{goodsId,jdbcType=VARCHAR}
  </update>

  <!--查询商品排名-->
  <select id="queryRanking" resultType="map">
    select goods_name,sales_num from goods
    order by sales_num desc
    limit 10
  </select>

  <!--添加商品-->
  <insert id="addComment" parameterType="com.aim.flowershop.dao.entity.CommentEntity">
    insert into comments (goods_id,user_id,comment)
    values ((select goods_id from goods where goods_name=#{goodsName,jdbcType=VARCHAR}),(
    select user_id from users where token=#{token,jdbcType=VARCHAR}),#{comment})
  </insert>

  <!--查询评论-->
  <select id="queryComments" parameterType="java.lang.Integer" resultType="map">
    select user_id,comment from comments
    where goods_id = #{goodsId,jdbcType=INTEGER}
  </select>

  <!--删除商品-->
  <delete id="deleteComments" parameterType="java.lang.Integer" >
    delete from comments
    where goods_id=#{goodsId,jdbcType=INTEGER}
  </delete>

</mapper>